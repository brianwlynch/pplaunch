<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Settings</title>
    <style>
        html, body {
        display: flex;
        height: 100vh;
        align-items: center;
        justify-content: center;
        font-family: sans-serif;
        background: rgb(200, 200, 200)
        }

        .container {
        background: rgba(0,0,0,0);
        padding: 2rem;
        text-align: center;
        }

        h2 {
        margin-bottom: 1.5rem;
        }

        .form-group {
        margin-bottom: 1.2rem;
        }

        .tfc-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        }

        .tfc-wrapper span,
        .tfc-wrapper input {
        font-size: 1rem;
        }

        input[type="text"] {
        width: 100px;
        text-align: center;
        padding: 0.25rem;
        margin: 0 0.5rem;
        }

        label {
        font-weight: 500;
        }

        button {
        padding: 0.5rem 1rem;
        font-size: 1rem;
        border: none;
        border-radius: 4px;
        background-color: #007bff;
        color: white;
        cursor: pointer;
        }

        button:hover {
        background-color: #0056b3;
        }
    </style>
    <script>
      // const fs = require('fs');
      // const path = require('path');
      // const { app } = require('electron').remote || require('@electron/remote');
      // const { ipcRenderer } = require('electron');

      // const settingsPath = path.join(app.getPath('userData'), 'settings.json');

      window.onload = () => {
        const settings = window.settingsAPI.load();

        document.getElementById('debugMode').checked = !! settings.DEBUG;
        
        if(settings.TFC_INSTANCE === "none") {
          document.getElementById('tfcInstance').value = '';
        } else {
          document.getElementById('tfcInstance').value = settings.TFC_INSTANCE || '';
        }
        
        select.value = settings.BASE_URL || "nep";
        console.log(settings.BASE_URL || "nep");
        const config = optionsConfig[select.value];
        baseURL.textContent = config.base;
        config.show.forEach(id => document.getElementById(id).style.display = "block");
        config.hide.forEach(id => document.getElementById(id).style.display = "none");
        

        document.getElementById('customInstance').value = settings.CUSTOM_INSTANCE || '';

      };

      function saveSettings() {

        window.settingsAPI.save( {
          DEBUG: document.getElementById('debugMode').checked,
          TFC_INSTANCE: document.getElementById('tfcInstance').value,
          BASE_URL: document.getElementById('baseURLDropdown').value,
          CUSTOM_INSTANCE: document.getElementById('customInstance').value,
        });
        window.settingsAPI.notifyUpdate();

        window.close();
      }

    </script>
</head>
<body>
  <div class="container">
    <h2>Settings</h2>

    <div class="form-group">
      <label>
        <input type="checkbox" id="debugMode" />
        Debug Mode
      </label>
    </div>

    <div class="form-group">
      <label for="baseURLDropdown"><b><u>TFC Base URL:</u></b></label><br>
      <select
        name="baseURLDropdown"
        id="baseURLDropdown"
        style="width: 150px;
               height: 50px;
               line-height: 50px;
               text-align: center;">
        <option value="nep">.NEPGroup.io</option>
        <option value="tfc">.TFCLabs.com</option>
        <option value="demo">Demo Mode</option>
        <option value="custom">Custom URL</option>
      </select>
    </div>


    <div class="form-group" id="tfcInstanceDiv">
      <label for="tfcInstance"><b><u>TFC Instance:</u></b></label>
      <div class="tfc-wrapper">
        <span>https://control.</span>
        <input type="text" id="tfcInstance" placeholder="tfc" />
        <span id="baseURL">.nepgroup.io</span>
      </div>
    </div>
    
    <div class="form-group" id="customDiv" style="display: none;">
      <label for="customInstance"><b><u>Custom URL:</u></b></label><br>
      <input type="text" id="customInstance" placeholder="http(s)://customURL.com" style="width:250px"/>
    </div>

    <div class="form-group" id="demoDiv" style="display: none;">
      <label for="demo"><b><u>Demo Mode:</u></b></label><br>
      <span id="demo">The panel will redirect to https://nepgroup.com</span>
    </div>

    <button onclick="saveSettings()">Save and Close</button>
  </div>
  
  <script>
    const select = document.getElementById("baseURLDropdown");
    const baseURL = document.getElementById("baseURL");
    const demoDiv = document.getElementById("demoDiv");
    const tfcInstanceDiv = document.getElementById("tfcInstanceDiv");
    const customDiv = document.getElementById("customDiv");

    const optionsConfig = {
      nep: {
        base: ".nepgroup.io",
        show: ["tfcInstanceDiv"],
        hide: ["demoDiv", "customDiv"]
      },
      tfc: {
        base: ".tfclabs.com",
        show: ["tfcInstanceDiv"],
        hide: ["demoDiv", "customDiv"]
      },
      demo: {
        base: "",
        show: ["demoDiv"],
        hide: ["tfcInstanceDiv", "customDiv"]
      },
      custom: {
        base: "",
        show: ["customDiv"],
        hide: ["demoDiv", "tfcInstanceDiv"]
      },
    }

    select.addEventListener("change", () => {
      const config = optionsConfig[select.value];
      baseURL.textContent = config.base;
      
      config.show.forEach(id => document.getElementById(id).style.display = "block");
      config.hide.forEach(id => document.getElementById(id).style.display = "none");

    });

  </script>
</body>
</html>